<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Confirmed - Welcome to FitSync!</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <header>
        <nav class="container">
            <div class="logo">FitSync</div>
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <li><a href="/about/">About</a></li>
                <li><a href="/#features">Features</a></li>
                <li><a href="/contact/">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="hero confirm-hero">
            <div class="container">
                <div class="hero-content">
                    <div class="success-icon">‚úÖ</div>
                    <h1>Email Confirmed!</h1>
                    <p id="confirmation-message">Welcome to FitSync! Your email has been successfully verified. You're all set to start your intelligent fitness journey.</p>
                </div>
            </div>
        </section>

        <section class="confirmation-content">
            <div class="container">
                <div class="next-steps">
                    <h2>What's Next?</h2>
                    <div class="steps-grid">
                        <div class="step-card">
                            <span class="step-number">1</span>
                            <h3>Download FitSync</h3>
                            <p>Get the app on your mobile device to start tracking your fitness journey with advanced analytics and insights.</p>
                        </div>
                        <div class="step-card">
                            <span class="step-number">2</span>
                            <h3>Complete Setup</h3>
                            <p>Set up your fitness profile, nutrition goals, and connect HealthKit for seamless data synchronization.</p>
                        </div>
                        <div class="step-card">
                            <span class="step-number">3</span>
                            <h3>Start Training</h3>
                            <p>Begin logging workouts, tracking nutrition, and visualizing your progress with our muscle mapping technology.</p>
                        </div>
                    </div>
                </div>

                <div class="app-download-section">
                    <h2>Download FitSync Now</h2>
                    <p>Continue your fitness journey on mobile with our comprehensive tracking and analytics platform.</p>
                    
                    <div class="download-buttons">
                        <a href="#" class="download-button ios" id="iosButton">
                            <div class="button-content">
                                <span class="store-icon">üì±</span>
                                <div class="button-text">
                                    <span class="small-text">Download on the</span>
                                    <span class="large-text">App Store</span>
                                </div>
                            </div>
                        </a>
                        <a href="#" class="download-button android" id="androidButton">
                            <div class="button-content">
                                <span class="store-icon">ü§ñ</span>
                                <div class="button-text">
                                    <span class="small-text">Get it on</span>
                                    <span class="large-text">Google Play</span>
                                </div>
                            </div>
                        </a>
                    </div>

                    <div class="deep-link-section">
                        <p class="deep-link-text">Already have FitSync installed?</p>
                        <a href="fitsync://confirm-email" class="deep-link-button" id="deepLinkButton">
                            Open in FitSync App
                        </a>
                    </div>
                </div>

                <div class="features-preview">
                    <h2>What You'll Get with FitSync</h2>
                    <div class="preview-grid">
                        <div class="preview-item">
                            <span class="preview-icon">üí™</span>
                            <h4>Muscle Mapping</h4>
                            <p>Visualize muscle development with interactive body mapping</p>
                        </div>
                        <div class="preview-item">
                            <span class="preview-icon">üçé</span>
                            <h4>Smart Nutrition</h4>
                            <p>Barcode scanning and intelligent macro tracking</p>
                        </div>
                        <div class="preview-item">
                            <span class="preview-icon">üìä</span>
                            <h4>Advanced Analytics</h4>
                            <p>Detailed progress tracking and performance insights</p>
                        </div>
                        <div class="preview-item">
                            <span class="preview-icon">üîÑ</span>
                            <h4>HealthKit Sync</h4>
                            <p>Seamless integration with Apple Health ecosystem</p>
                        </div>
                    </div>
                </div>

                <div class="success-actions">
                    <h2>Get Started Today</h2>
                    <p>Your FitSync account is ready. Download the app and begin tracking your fitness with the most intelligent platform available.</p>
                    <div class="action-buttons">
                        <a href="/" class="cta-button secondary">Explore Features</a>
                        <a href="/about/" class="cta-button secondary">Learn More</a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="download-section">
                <h3>Ready to Transform Your Fitness?</h3>
                <div class="app-store-buttons">
                    <a href="#" class="store-button ios">üì± Download for iOS</a>
                    <a href="#" class="store-button android">ü§ñ Get it on Android</a>
                </div>
            </div>
            <p>&copy; 2024 FitSync. All rights reserved. The complete fitness ecosystem for serious athletes.</p>
        </div>
    </footer>

    <script src="../js/main.js"></script>
    <script>
        // Handle URL parameters for confirmation status
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const token = urlParams.get('token');
            const confirmed = urlParams.get('confirmed');
            const error = urlParams.get('error');
            
            const messageElement = document.getElementById('confirmation-message');
            const heroTitle = document.querySelector('.confirm-hero h1');
            const successIcon = document.querySelector('.success-icon');
            
            if (error) {
                // Handle error states
                successIcon.textContent = '‚ùå';
                heroTitle.textContent = 'Confirmation Error';
                messageElement.textContent = 'There was an issue confirming your email. Please try again or contact support if the problem persists.';
                messageElement.style.color = '#dc3545';
            } else if (confirmed === 'false') {
                // Handle already confirmed or invalid token
                successIcon.textContent = '‚ö†Ô∏è';
                heroTitle.textContent = 'Already Confirmed';
                messageElement.textContent = 'This email has already been confirmed, or the confirmation link is invalid. You can proceed to download the app.';
                messageElement.style.color = '#ffc107';
            } else {
                // Default success state
                successIcon.textContent = '‚úÖ';
                heroTitle.textContent = 'Email Confirmed!';
                messageElement.textContent = 'Welcome to FitSync! Your email has been successfully verified. You\'re all set to start your intelligent fitness journey.';
            }

            // Try to open the app directly via deep link after a short delay
            if (!error && confirmed !== 'false') {
                setTimeout(() => {
                    const deepLink = document.getElementById('deepLinkButton');
                    if (deepLink && window.confirm('Would you like to open FitSync app now?')) {
                        deepLink.click();
                    }
                }, 2000);
            }
        });
        
        // Handle deep link button
        document.getElementById('deepLinkButton').addEventListener('click', function(e) {
            e.preventDefault();
            window.location.href = 'fitsync://confirm-email';
            
            // Fallback to app store if app not installed
            setTimeout(() => {
                if (confirm('FitSync app not found. Would you like to download it?')) {
                    // Detect mobile OS and redirect accordingly
                    const userAgent = navigator.userAgent || navigator.vendor || window.opera;
                    if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
                        document.getElementById('iosButton').click();
                    } else if (/android/i.test(userAgent)) {
                        document.getElementById('androidButton').click();
                    } else {
                        // Desktop fallback
                        document.getElementById('iosButton').click();
                    }
                }
            }, 1500);
        });
    </script>
</body>
</html>